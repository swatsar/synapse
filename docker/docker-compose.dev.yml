version: '3.8'
services:
  synapse-core:
    build:
      context: ..
      dockerfile: docker/Dockerfile
    image: synapse/core:3.1.0-dev
    container_name: synapse-core-dev
    ports:
    - 8000:8000
    - 9090:9090
    volumes:
    - ../synapse:/app/synapse
    - ../config:/app/config
    - ../skills:/app/skills
    - ../tests:/app/tests
    environment:
    - MODE=development
    - DATABASE_URL=sqlite:///./data/synapse_dev.db
    - VECTOR_DB_URL=http://qdrant:6333
    - REDIS_URL=redis://redis:6379
    - PROTOCOL_VERSION=1.0
    - SPEC_VERSION=3.1
    - LOG_LEVEL=DEBUG
    depends_on:
      qdrant:
        condition: service_healthy
      redis:
        condition: service_healthy
    networks:
    - synapse-network
  qdrant:
    image: qdrant/qdrant:latest
    container_name: synapse-qdrant-dev
    ports:
    - 6333:6333
    healthcheck:
      test:
      - CMD
      - curl
      - -f
      - http://localhost:6333/readyz
      interval: 10s
      timeout: 5s
      retries: 5
    networks:
    - synapse-network
  redis:
    image: redis:7
    container_name: synapse-redis-dev
    healthcheck:
      test:
      - CMD
      - redis-cli
      - ping
      interval: 10s
      timeout: 5s
      retries: 5
    networks:
    - synapse-network
networks:
  synapse-network:
    driver: bridge
